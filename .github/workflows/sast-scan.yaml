name: Static Application Security Testing

# Runs when a pull request review is being submitted
on: 
  push:  
      branches: [ "coverity-workflow" ] 

  # Run this workflow manually from Actions tab
  workflow_dispatch:
    inputs:
      branch_to_test:
        description: 'Branch or tag to run test'
        required: true
        default: 'main'
        type: string

# Allow one concurrent deployment
concurrency:
  group: ${{ github.repository }}-${{ github.workflow }}
  cancel-in-progress: true

jobs:
  static-application-security-testing:

    runs-on: ubuntu-latest
    timeout-minutes: 10

    steps:

      - name: Install Coverity Thin Client
        run: |
          curl -fLOsS ${{ vars.COV_URL}}/api/v2/scans/downloads/cov-thin-client-linux64-2023.6.2.tar.gz | tar -C $RUNNER_TEMP -xzf -
          export PATH=$PATH:$RUNNER_TEMP/bin

